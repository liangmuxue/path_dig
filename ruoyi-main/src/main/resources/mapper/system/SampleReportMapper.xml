<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.main.mapper.SampleReportMapper">
    
    <resultMap type="com.ruoyi.main.domain.SampleReport" id="SampleReportResult">
        <result property="id"    column="id"    />
        <result property="samplePid"    column="sample_pid"    />
        <result property="quality"    column="quality"    />
        <result property="sampleId"    column="sample_id"    />
        <result property="aiDiagnosis"    column="ai_diagnosis"    />
        <result property="doctorDiagnosis"    column="doctor_diagnosis"    />
        <result property="inspectDoctor"    column="inspect_doctor"    />
        <result property="verifyDoctor"    column="verify_doctor"    />
        <result property="aiTime"    column="ai_time"    />
        <result property="reportTime"    column="report_time"    />
        <result property="updateTime"    column="update_time"    />
        <result property="state"    column="state"    />
        <result property="picOne"    column="picOne"    />
        <result property="picTwo"    column="picTwo"    />
        <result property="picBig"    column="picBig"    />
        <result property="size"    column="size"    />
        <result property="disease"    column="disease"    />
        <result property="done"    column="done"    />
    </resultMap>

    <sql id="selectSampleReportVo">
        select id, sample_pid, quality, sample_id, ai_diagnosis, doctor_diagnosis, inspect_doctor, verify_doctor, ai_time,
               report_time, update_time, state,picOne,picTwo,picBig,size,disease,done from sample_report
    </sql>

    <select id="selectSampleReportList" parameterType="com.ruoyi.main.domain.SampleReport" resultMap="SampleReportResult">
        <include refid="selectSampleReportVo"/>
        <where>  
            <if test="samplePid != null "> and sample_pid = #{samplePid}</if>
            <if test="quality != null "> and quality = #{quality}</if>
            <if test="sampleId != null  and sampleId != ''"> and sample_id = #{sampleId}</if>
            <if test="aiDiagnosis != null  and aiDiagnosis != ''"> and ai_diagnosis = #{aiDiagnosis}</if>
            <if test="doctorDiagnosis != null  and doctorDiagnosis != ''"> and doctor_diagnosis = #{doctorDiagnosis}</if>
            <if test="inspectDoctor != null "> and inspect_doctor = #{inspectDoctor}</if>
            <if test="verifyDoctor != null "> and verify_doctor = #{verifyDoctor}</if>
            <if test="aiTime != null  and aiTime != ''"> and ai_time = #{aiTime}</if>
            <if test="reportTime != null  and reportTime != ''"> and report_time = #{reportTime}</if>
            <if test="state != null "> and state = #{state}</if>
        </where>
    </select>
    
    <select id="selectSampleReportById" parameterType="Long" resultMap="SampleReportResult">
        <include refid="selectSampleReportVo"/>
        where id = #{id}
    </select>
    <select id="checkHaveReport" resultType="java.lang.Integer">
        select count(id) from sample_report
        where sample_pid = #{samplePid}
    </select>
    <select id="selectSampleReportBySampleId" resultMap="SampleReportResult">
        <include refid="selectSampleReportVo"/>
        where sample_id = #{sampleId}
    </select>
    <select id="selectSampleReportPageList" resultMap="SampleReportResult">
        <include refid="selectSampleReportVo"/>
        <where>
            <if test="samplePid != null "> and sample_pid = #{samplePid}</if>
            <if test="quality != null "> and quality = #{quality}</if>
            <if test="sampleId != null  and sampleId != ''">and sample_id LIKE CONCAT('%', #{sampleId}, '%')</if>
            <if test="aiDiagnosis != null  and aiDiagnosis != ''"> and ai_diagnosis = #{aiDiagnosis}</if>
            <if test="doctorDiagnosis != null  and doctorDiagnosis != ''"> and doctor_diagnosis = #{doctorDiagnosis}</if>
            <if test="inspectDoctor != null "> and inspect_doctor = #{inspectDoctor}</if>
            <if test="verifyDoctor != null "> and verify_doctor = #{verifyDoctor}</if>
            <if test="aiTime != null  and aiTime != ''"> and ai_time = #{aiTime}</if>
            <if test="reportTime != null  and reportTime != ''"> and report_time = #{reportTime}</if>
            <if test="updateTime != null  and updateTime != ''"> and update_time = #{updateTime}</if>
            <if test="state != null "> and state = #{state}</if>
            <if test="startTime != null "> and ai_time >= #{startTime}</if>
            <if test="endTime != null "> and ai_time &lt;=  #{endTime}</if>
             and done = 1
        </where>
        order by update_time desc
    </select>
    <select id="selectSampleReportBySamplePId" resultMap="SampleReportResult">
        <include refid="selectSampleReportVo"/>
        where sample_pid = #{samplePid}
    </select>

    <insert id="insertSampleReport" parameterType="com.ruoyi.main.domain.SampleReport" useGeneratedKeys="true" keyProperty="id">
        insert into sample_report
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="samplePid != null">sample_pid,</if>
            <if test="quality != null">quality,</if>
            <if test="sampleId != null">sample_id,</if>
            <if test="aiDiagnosis != null">ai_diagnosis,</if>
            <if test="doctorDiagnosis != null">doctor_diagnosis,</if>
            <if test="inspectDoctor != null">inspect_doctor,</if>
            <if test="verifyDoctor != null">verify_doctor,</if>
            <if test="aiTime != null">ai_time,</if>
            <if test="reportTime != null">report_time,</if>
            <if test="updateTime != null">update_time,</if>
            <if test="state != null">state,</if>
            <if test="picOne != null">picOne,</if>
            <if test="picTwo != null">picTwo,</if>
            <if test="picBig != null">picBig,</if>
            <if test="size != null">size,</if>
            <if test="disease != null">disease,</if>
            <if test="done != null">done,</if>
         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="samplePid != null">#{samplePid},</if>
            <if test="quality != null">#{quality},</if>
            <if test="sampleId != null">#{sampleId},</if>
            <if test="aiDiagnosis != null">#{aiDiagnosis},</if>
            <if test="doctorDiagnosis != null">#{doctorDiagnosis},</if>
            <if test="inspectDoctor != null">#{inspectDoctor},</if>
            <if test="verifyDoctor != null">#{verifyDoctor},</if>
            <if test="aiTime != null">#{aiTime},</if>
            <if test="reportTime != null">#{reportTime},</if>
            <if test="updateTime != null">#{updateTime},</if>
            <if test="state != null">#{state},</if>
            <if test="picOne != null">#{picOne},</if>
            <if test="picTwo != null">#{picTwo},</if>
            <if test="picBig != null">#{picBig},</if>
            <if test="size != null">#{size},</if>
            <if test="disease != null">#{disease},</if>
            <if test="done != null">#{done},</if>
         </trim>
    </insert>

    <update id="updateSampleReport" parameterType="com.ruoyi.main.domain.SampleReport">
        update sample_report
        <trim prefix="SET" suffixOverrides=",">
            <if test="samplePid != null">sample_pid = #{samplePid},</if>
            <if test="quality != null">quality = #{quality},</if>
            <if test="sampleId != null">sample_id = #{sampleId},</if>
            <if test="aiDiagnosis != null">ai_diagnosis = #{aiDiagnosis},</if>
            <if test="doctorDiagnosis != null">doctor_diagnosis = #{doctorDiagnosis},</if>
            <if test="inspectDoctor != null">inspect_doctor = #{inspectDoctor},</if>
            <if test="verifyDoctor != null">verify_doctor = #{verifyDoctor},</if>
            <if test="aiTime != null">ai_time = #{aiTime},</if>
            <if test="reportTime != null">report_time = #{reportTime},</if>
            <if test="updateTime != null">update_time = #{updateTime},</if>
            <if test="state != null">state = #{state},</if>
            <if test="picOne != null">picOne = #{picOne},</if>
            <if test="picTwo != null">picTwo = #{picTwo},</if>
            <if test="picBig != null">picBig = #{picBig},</if>
            <if test="size != null">size = #{size},</if>
            <if test="disease != null">disease = #{disease},</if>
            <if test="done != null">done = #{done},</if>
        </trim>
        where id = #{id}
    </update>

    <delete id="deleteSampleReportById" parameterType="Long">
        delete from sample_report where id = #{id}
    </delete>

    <delete id="deleteSampleReportByIds" parameterType="String">
        delete from sample_report where id in 
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
    <delete id="deleteSampleReportBySamplePid">
        delete from sample_report where sample_pid = #{samplePid}
    </delete>
    <delete id="deleteSampleReportBySampleIds">
        delete from sample_report where sample_pid in
        <foreach item="id" collection="array" open="(" separator="," close=")">
            #{id}
        </foreach>
    </delete>
</mapper>